{% extends "base.html" %}
{% load mathfilters custom_filters %}

{% block content %}
<h1>Final Round - {{ final_round.tournament.name }}</h1>

{% load static %}

<style>
    .tournament-container {
        display: flex;
        flex-direction: column;
    }

    .round-container {
        display: flex;
        flex-direction: row;
        justify-content: space-around;
        margin-bottom: 20px;
    }

    .round {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        margin: 0 20px;
    }

    .match {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        border: 1px solid black;
        border-radius: 5px;
        padding: 5px;
        margin-bottom: 10px;
        width: 150px;
        text-align: center;
    }
</style>


<p>Total matches: {{ final_round.matches.all|length }}</p>

<!-- {% for match in final_round.matches.all %}
<p>Match ID: {{ match.id }}, Team 1: {{ match.team1.name }}, Team 2: {{ match.team2.name }}</p>
{% endfor %} -->

<div class="tournament-container">
    <div class="round">
        {% for match in final_round.matches.all %}
        <div class="match">
            <div>{{ match.team1.name }} {% if match.score1 %}({{ match.score1 }}){% endif %}</div>
            <div>{{ match.team2.name }} {% if match.score2 %}({{ match.score2 }}){% endif %}</div>
            <div>Date: {{ match.date }}</div>
            <div>Hour: {{ match.hour }}</div>
            <div>Place: {{ match.place }}</div>

            {% if user.is_authenticated and user.is_superuser %}
            <form method="POST">
                {% csrf_token %}
                <div class="form-group">
                    <label for="team1_score">Score de l'équipe 1 :</label>
                    <input type="number" name="team1_score-{{ match.id }}" id="team1_score-{{ match.id }}"
                        class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="team2_score">Score de l'équipe 2 :</label>
                    <input type="number" name="team2_score-{{ match.id }}" id="team2_score-{{ match.id }}"
                        class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Submit Scores</button>
            </form>
            {%endif%}
        </div>

        {% endfor %}
    </div>
    <div class="round">
        {% for match in next_round_matches %}
        {% if match.team1 and match.team2 %}
        <div class="match">
            <div>{{ match.team1.name }} {% if match.score1 %}({{ match.score1 }}){% endif %}</div>
            <div>{{ match.team2.name }} {% if match.score2 %}({{ match.score2 }}){% endif %}</div>
            <div>Date: {{ match.date }}</div>
            <div>Hour: {{ match.hour }}</div>
            <div>Place: {{ match.place }}</div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>

{% endblock %}